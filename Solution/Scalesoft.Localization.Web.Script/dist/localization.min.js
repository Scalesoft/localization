var Localization=function(){function t(){this.mGlobalScope="global",this.mCultureCookieName="Localization.Culture",this.mDictionary={},this.mPluralizedDictionary={}}return t.prototype.translate=function(t,i,n){var r=this.getDictionary(i,n).translate(t);return null==r?this.getFallbackTranslation(t,i,n):r},t.prototype.translateAsync=function(n,r,o,a){var e=this;this.getDictionaryAsync(function(t){var i=t.translate(r);if(null==i)return e.getFallbackTranslation(r,o,a);n(i)},o,a)},t.prototype.translateFormat=function(t,i,n,r){var o=this.getDictionary(n,r).translateFormat(t,i);return null==o?this.getFallbackTranslation(t,n,r):o},t.prototype.translateFormatAsync=function(n,r,o,a,e){var l=this;this.getDictionaryAsync(function(t){var i=t.translateFormat(r,o);if(null==i)return l.getFallbackTranslation(r,a,e);n(i)},a,e)},t.prototype.translatePluralization=function(i,t,n,r){var o=this.getPluralizationDictionary(n,r);try{var a=o.translatePluralization(i,t);return null==a?this.getFallbackTranslation(i,n,r):a}catch(t){return this.handleError(t,i)}},t.prototype.translatePluralizationAsync=function(n,r,o,a,e){var l=this;this.getPluralizationDictionaryAsync(function(t){try{var i=t.translatePluralization(r,o);if(null==i)return l.getFallbackTranslation(r,a,e);n(i)}catch(t){n(l.handleError(t,r))}},a,e)},t.prototype.getFallbackTranslation=function(t,i,n){return console.log("Localized string with key="+t+" was not found in dictionary="+i+" with culture="+n),{name:t,value:"X{undefined}",resourceNotFound:!0}},t.prototype.handleError=function(t,i){return console.error(t.message),{name:i,value:"X{error}",resourceNotFound:!0}},t.prototype.configureSiteUrl=function(t){this.mSiteUrl=t},t.prototype.getDictionary=function(t,i){return t=this.checkScope(t),i=this.checkCultureName(i),this.getLocalizationDictionary(t,i)},t.prototype.getDictionaryAsync=function(t,i,n){return i=this.checkScope(i),n=this.checkCultureName(n),this.getLocalizationDictionaryAsync(i,n,t)},t.prototype.getPluralizationDictionary=function(t,i){return t=this.checkScope(t),i=this.checkCultureName(i),this.getPluralizationLocalizationDictionary(t,i)},t.prototype.getPluralizationDictionaryAsync=function(t,i,n){return i=this.checkScope(i),n=this.checkCultureName(n),this.getPluralizationLocalizationDictionaryAsync(i,n,t)},t.prototype.checkCultureName=function(t){return t||this.getCurrentCulture()},t.prototype.checkScope=function(t){return t||this.mGlobalScope},t.prototype.getLocalizationDictionary=function(t,i){var n=this.dictionaryKey(t,i),r=this.mDictionary[n];return void 0===r?(this.downloadDictionary(t,i),this.mDictionary[n]):r},t.prototype.getLocalizationDictionaryAsync=function(t,i,n){var r=this.dictionaryKey(t,i),o=this.mDictionary[r];void 0===o&&this.downloadDictionary(t,i,n),n(o)},t.prototype.getPluralizationLocalizationDictionary=function(t,i){var n=this.dictionaryKey(t,i),r=this.mPluralizedDictionary[n];return void 0===r?(this.downloadPluralizedDictionary(t,i),this.mPluralizedDictionary[n]):r},t.prototype.getPluralizationLocalizationDictionaryAsync=function(t,i,n){var r=this.dictionaryKey(t,i),o=this.mPluralizedDictionary[r];void 0===o&&this.downloadPluralizedDictionary(t,i,n),n(o)},t.prototype.dictionaryKey=function(t,i){return t.concat("|",i)},t.prototype.downloadDictionary=function(n,r,o){var a=this,e=new XMLHttpRequest;e.onreadystatechange=function(){if(e.readyState===XMLHttpRequest.DONE&&200===e.status){var t=e.responseText,i=a.dictionaryKey(n,r);void 0===a.mDictionary[i]&&(a.mDictionary[i]=new LocalizationDictionary(t)),void 0!==o&&o(a.mDictionary[i])}};var t=this.mSiteUrl;t&&"/"===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1)),e.open("GET",t+"/Localization/Dictionary?scope="+n,void 0!==o),e.send()},t.prototype.downloadPluralizedDictionary=function(n,r,o){var a=this,e=new XMLHttpRequest;e.onreadystatechange=function(){if(e.readyState===XMLHttpRequest.DONE&&200===e.status){var t=e.responseText,i=a.dictionaryKey(n,r);void 0===a.mPluralizedDictionary[i]&&(a.mPluralizedDictionary[i]=new LocalizationPluralizationDictionary(t)),void 0!==o&&o(a.mPluralizedDictionary[i])}};var t=this.mSiteUrl;t&&"/"===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1)),e.open("GET",t+"/Localization/PluralizedDictionary?scope="+n,void 0!==o),e.send()},t.prototype.getCurrentCulture=function(){if(void 0===this.mCurrentCulture){var t=this.getCurrentCultureCookie();this.setCurrentCulture(t)}return this.mCurrentCulture},t.prototype.setCurrentCulture=function(t){this.mCurrentCulture=t},t.prototype.getCurrentCultureCookie=function(){return LocalizationUtils.getCookie(this.mCultureCookieName)},t}(),LocalizationDictionary=function(){function t(t){this.mDictionary=JSON.parse(t)}return t.prototype.translate=function(t){var i=this.mDictionary[t];return void 0===i?null:i},t.prototype.translateFormat=function(t,i){var n=this.translate(t);return{name:t,value:i?this.formatString(n,i):n.value,resourceNotFound:n.resourceNotFound}},t.prototype.formatString=function(t,o){return t.value.replace(/\{\s*([^}\s]+)\s*\}/g,function(t,i,n,r){return o[i]})},t}(),LocalizationPluralizationDictionary=function(){function t(t){this.mDictionary=JSON.parse(t)}return t.prototype.translatePluralization=function(t,i){var n=this.mDictionary[t];if(null==n)return null;for(var r=0,o=n.intervals;r<o.length;r++){var a=o[r],e=a.interval;if(LocalizationUtils.isInInterval(i,e))return a.localizedString}return n.defaultLocalizedString},t}(),PluralizationInterval=function(t,i){if(i<t)throw new Error("The start value should be less or equal than end.");this.start=t,this.end=i},LocalizationUtils=function(){function t(){}return t.getCookie=function(i){return i+="=",document.cookie.split(";").map(function(t){return t.trim()}).filter(function(t){return 0===t.indexOf(i)}).map(function(t){return decodeURIComponent(t.substring(i.length))})[0]||null},t.isInInterval=function(t,i){return!!i&&(i.start<=t&&t<=i.end)},t}();