var LocalizationErrorResolution,LocalizationStatusSuccess=function(t,i){return{success:!0,message:"Success",text:t,scope:i}},Localization=function(){function t(t){this.mGlobalScope="global",this.mCultureCookieName="Localization.Culture",this.mDictionary={},this.mDictionaryQueue={},this.mPluralizedDictionary={},this.mPluralizedDictionaryQueue={},this.mErrorHandlerCalled=!1,this.mLocalizationConfiguration=null==t?{errorResolution:LocalizationErrorResolution.Key}:t}return t.prototype.callErrorHandler=function(t){this.mErrorHandlerCalled||(this.mErrorHandlerCalled=!0,void 0!==this.mLocalizationConfiguration.onError&&this.mLocalizationConfiguration.onError(t))},t.prototype.getTranslationOnError=function(t,i){switch(this.mLocalizationConfiguration.errorResolution){case LocalizationErrorResolution.Null:return null;case LocalizationErrorResolution.Key:return{name:t,resourceNotFound:!0,value:t}}},t.prototype.translate=function(t,i,e){var o=this.getDictionary(i,e).translate(t);return null==o?this.getFallbackTranslation(t,i,e):o},t.prototype.translateAsync=function(r,n,a){var u=this;return new Promise(function(e,o){u.getDictionaryAsync(function(t){var i=t.translate(r);null==i&&e({value:u.getFallbackTranslation(r,n,a),status:LocalizationStatusSuccess(r,n)}),e({value:i,status:LocalizationStatusSuccess(r,n)})},function(t){var i={success:!1,message:"Unable to load required dictionary",errorType:"loadDictionary",text:r,scope:t.scope,context:t.context};u.callErrorHandler(i),o({value:u.getTranslationOnError(r,n),status:LocalizationStatusSuccess(r,n)})},n,a)})},t.prototype.translateFormat=function(t,i,e,o){var r=this.getDictionary(e,o).translateFormat(t,i);return null==r?this.getFallbackTranslation(t,e,o):r},t.prototype.translateFormatAsync=function(r,n,a,u){var s=this;return new Promise(function(e,o){s.getDictionaryAsync(function(t){var i=t.translateFormat(r,n);null==i&&e({value:s.getFallbackTranslation(r,a,u),status:LocalizationStatusSuccess(r,a)}),e({value:i,status:LocalizationStatusSuccess(r,a)})},function(t){var i={success:!1,message:"Unable to load required dictionary",errorType:"loadDictionary",text:r,scope:t.scope,context:t.context};s.callErrorHandler(i),o({value:s.getTranslationOnError(r,a),status:LocalizationStatusSuccess(r,a)})},a,u)})},t.prototype.translatePluralization=function(i,t,e,o){var r=this.getPluralizationDictionary(e,o);try{var n=r.translatePluralization(i,t);return null==n?this.getFallbackTranslation(i,e,o):n}catch(t){return this.handleError(t,i)}},t.prototype.translatePluralizationAsync=function(r,n,a,u){var s=this;return new Promise(function(e,o){s.getPluralizationDictionaryAsync(function(t){try{var i=t.translatePluralization(r,n);null==i&&e({value:s.getFallbackTranslation(r,a,u),status:LocalizationStatusSuccess(r,a)}),e({value:i,status:LocalizationStatusSuccess(r,a)})}catch(t){o({value:s.handleError(t,r),status:{success:!1,message:t.message,errorType:"exception",text:r,scope:a}})}},function(t){var i={success:!1,message:"Unable to load required pluralization dictionary",errorType:"loadDictionary",text:r,scope:t.scope,context:t.context};s.callErrorHandler(i),o({value:s.getTranslationOnError(r,a),status:LocalizationStatusSuccess(r,a)})},a,u)})},t.prototype.getFallbackTranslation=function(t,i,e){return console.log("Localized string with key="+t+" was not found in dictionary="+i+" with culture="+e),{name:t,value:"X{undefined}",resourceNotFound:!0}},t.prototype.handleError=function(t,i){return console.error(t.message),{name:i,value:"X{error}",resourceNotFound:!0}},t.prototype.configureSiteUrl=function(t){this.mSiteUrl=t},t.prototype.getDictionary=function(t,i){return t=this.checkScope(t),i=this.checkCultureName(i),this.getLocalizationDictionary(t,i)},t.prototype.getDictionaryAsync=function(t,i,e,o){return e=this.checkScope(e),o=this.checkCultureName(o),this.getLocalizationDictionaryAsync(e,o,t,i)},t.prototype.getPluralizationDictionary=function(t,i){return t=this.checkScope(t),i=this.checkCultureName(i),this.getPluralizationLocalizationDictionary(t,i)},t.prototype.getPluralizationDictionaryAsync=function(t,i,e,o){return e=this.checkScope(e),o=this.checkCultureName(o),this.getPluralizationLocalizationDictionaryAsync(e,o,t,i)},t.prototype.checkCultureName=function(t){return t||this.getCurrentCulture()},t.prototype.checkScope=function(t){return t||this.mGlobalScope},t.prototype.getLocalizationDictionary=function(t,i){var e=this.dictionaryKey(t,i),o=this.mDictionary[e];return void 0===o?(this.downloadDictionary(t,i),this.mDictionary[e]):o},t.prototype.getLocalizationDictionaryAsync=function(t,i,e,o){var r=this.dictionaryKey(t,i),n=this.mDictionary[r];void 0===n?this.downloadDictionaryAsync(t,i,e,o):e(n)},t.prototype.getPluralizationLocalizationDictionary=function(t,i){var e=this.dictionaryKey(t,i),o=this.mPluralizedDictionary[e];return void 0===o?(this.downloadPluralizedDictionary(t,i),this.mPluralizedDictionary[e]):o},t.prototype.getPluralizationLocalizationDictionaryAsync=function(t,i,e,o){var r=this.dictionaryKey(t,i),n=this.mPluralizedDictionary[r];void 0===n?this.downloadPluralizedDictionaryAsync(t,i,e,o):e(n)},t.prototype.dictionaryKey=function(t,i){return t.concat("|",i)},t.prototype.downloadDictionary=function(i,t){var e=this,o=this.dictionaryKey(i,t);void 0===this.mDictionaryQueue[i]&&(this.mDictionaryQueue[i]=[]);var r=new XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState===XMLHttpRequest.DONE&&200===r.status){var t=r.responseText;void 0===e.mDictionary[o]&&(e.mDictionary[o]=new LocalizationDictionary(t)),e.processDictionaryQueue(i,o)}},r.open("GET",this.getBaseUrl()+"/Localization/Dictionary?scope="+i,!1),r.send()},t.prototype.downloadDictionaryAsync=function(i,t,e,o){var r=this,n=this.dictionaryKey(i,t);if(void 0===this.mDictionaryQueue[i]){this.mDictionaryQueue[i]=[];var a=new XMLHttpRequest;a.onreadystatechange=function(){if(a.readyState===XMLHttpRequest.DONE)if(200===a.status){var t=a.responseText;void 0===r.mDictionary[n]&&(r.mDictionary[n]=new LocalizationDictionary(t)),r.processDictionaryQueue(i,n)}else o({scope:i,context:a})},a.open("GET",this.getBaseUrl()+"/Localization/Dictionary?scope="+i,!0),a.send()}this.mDictionaryQueue[i].push(e),this.processDictionaryQueue(i,n)},t.prototype.processDictionaryQueue=function(t,i){if(void 0!==this.mDictionary[i])for(var e=this.mDictionaryQueue[t].shift();void 0!==e;)e(this.mDictionary[i]),e=this.mDictionaryQueue[t].shift()},t.prototype.downloadPluralizedDictionary=function(i,t){var e=this,o=this.dictionaryKey(i,t);void 0===this.mPluralizedDictionaryQueue[i]&&(this.mPluralizedDictionaryQueue[i]=[]);var r=new XMLHttpRequest;r.onreadystatechange=function(){if(r.readyState===XMLHttpRequest.DONE&&200===r.status){var t=r.responseText;void 0===e.mPluralizedDictionary[o]&&(e.mPluralizedDictionary[o]=new LocalizationPluralizationDictionary(t)),e.processPluralizedDictionaryQueue(i,o)}},r.open("GET",this.getBaseUrl()+"/Localization/PluralizedDictionary?scope="+i,!1),r.send()},t.prototype.downloadPluralizedDictionaryAsync=function(i,t,e,o){var r=this,n=this.dictionaryKey(i,t);if(void 0===this.mPluralizedDictionaryQueue[i]){this.mPluralizedDictionaryQueue[i]=[];var a=new XMLHttpRequest;a.onreadystatechange=function(){if(a.readyState===XMLHttpRequest.DONE)if(200===a.status){var t=a.responseText;void 0===r.mPluralizedDictionary[n]&&(r.mPluralizedDictionary[n]=new LocalizationPluralizationDictionary(t)),r.processPluralizedDictionaryQueue(i,n)}else o({scope:i,context:a})},a.open("GET",this.getBaseUrl()+"/Localization/PluralizedDictionary?scope="+i,!0),a.send()}this.mPluralizedDictionaryQueue[i].push(e),this.processPluralizedDictionaryQueue(i,n)},t.prototype.processPluralizedDictionaryQueue=function(t,i){if(void 0!==this.mPluralizedDictionary[i])for(var e=this.mPluralizedDictionaryQueue[t].shift();void 0!==e;)e(this.mPluralizedDictionary[i]),e=this.mPluralizedDictionaryQueue[t].shift()},t.prototype.getDownloadPromise=function(r,t){var n=this,a=this.dictionaryKey(r,t);return new Promise(function(i,e){var o=new XMLHttpRequest;o.open("GET",n.getBaseUrl()+"/Localization/PluralizedDictionary?scope="+r,!0),o.send(),o.onreadystatechange=function(){if(o.readyState===XMLHttpRequest.DONE)if(200<=o.status&&o.status<300){var t=o.responseText;void 0===n.mPluralizedDictionary[a]&&(n.mPluralizedDictionary[a]=new LocalizationPluralizationDictionary(t)),i(n.mPluralizedDictionary[a])}else e({scope:r,status:o.status,statusText:o.statusText,context:o})}})},t.prototype.getBaseUrl=function(){var t=this.mSiteUrl;return t&&"/"===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1)),t},t.prototype.getCurrentCulture=function(){if(void 0===this.mCurrentCulture){var t=this.getParsedCultureCookie(),i=null===t.CurrentCulture?t.DefaultCulture:t.CurrentCulture;this.setCurrentCulture(i)}return this.mCurrentCulture},t.prototype.setCurrentCulture=function(t){this.mCurrentCulture=t},t.prototype.getParsedCultureCookie=function(){var t=this.getCurrentCultureCookie(),i=JSON.parse(t);return void 0!==i.DefaultCulture&&void 0!==i.CurrentCulture||console.error("Unexpected value of the cookie "+this.mCultureCookieName+". Expected object with properties 'DefaultCulture', and 'CurrentCulture'.",i),i},t.prototype.getCurrentCultureCookie=function(){return LocalizationUtils.getCookie(this.mCultureCookieName)},t}(),LocalizationDictionary=function(){function t(t){this.mDictionary=JSON.parse(t)}return t.prototype.translate=function(t){var i=this.mDictionary[t];return void 0===i?null:i},t.prototype.translateFormat=function(t,i){var e=this.translate(t);return{name:t,value:i?this.formatString(e,i):e.value,resourceNotFound:e.resourceNotFound}},t.prototype.formatString=function(t,r){return t.value.replace(/\{\s*([^}\s]+)\s*\}/g,function(t,i,e,o){return r[i]})},t}(),LocalizationPluralizationDictionary=function(){function t(t){this.mDictionary=JSON.parse(t)}return t.prototype.translatePluralization=function(t,i){var e=this.mDictionary[t];if(null==e)return null;for(var o=0,r=e.intervals;o<r.length;o++){var n=r[o],a=n.interval;if(LocalizationUtils.isInInterval(i,a))return n.localizedString}return e.defaultLocalizedString},t}();!function(t){t[t.Null=0]="Null",t[t.Key=1]="Key"}(LocalizationErrorResolution=LocalizationErrorResolution||{});var PluralizationInterval=function(t,i){if(i<t)throw new Error("The start value should be less or equal than end.");this.start=t,this.end=i},LocalizationUtils=function(){function t(){}return t.getCookie=function(i){return i+="=",document.cookie.split(";").map(function(t){return t.trim()}).filter(function(t){return 0===t.indexOf(i)}).map(function(t){return decodeURIComponent(t.substring(i.length))})[0]||null},t.isInInterval=function(t,i){return!!i&&(i.start<=t&&t<=i.end)},t}();