var Localization=function(){function t(){this.mGlobalScope="global",this.mCultureCookieName="Localization.Culture",this.mDictionary={},this.mDictionaryQueue={},this.mPluralizedDictionary={},this.mPluralizedDictionaryQueue={}}return t.prototype.translate=function(t,i,r){var e=this.getDictionary(i,r).translate(t);return null==e?this.getFallbackTranslation(t,i,r):e},t.prototype.translateAsync=function(r,e,n,o){var a=this;this.getDictionaryAsync(function(t){var i=t.translate(e);if(null==i)return a.getFallbackTranslation(e,n,o);r(i)},n,o)},t.prototype.translateFormat=function(t,i,r,e){var n=this.getDictionary(r,e).translateFormat(t,i);return null==n?this.getFallbackTranslation(t,r,e):n},t.prototype.translateFormatAsync=function(r,e,n,o,a){var u=this;this.getDictionaryAsync(function(t){var i=t.translateFormat(e,n);if(null==i)return u.getFallbackTranslation(e,o,a);r(i)},o,a)},t.prototype.translatePluralization=function(i,t,r,e){var n=this.getPluralizationDictionary(r,e);try{var o=n.translatePluralization(i,t);return null==o?this.getFallbackTranslation(i,r,e):o}catch(t){return this.handleError(t,i)}},t.prototype.translatePluralizationAsync=function(r,e,n,o,a){var u=this;this.getPluralizationDictionaryAsync(function(t){try{var i=t.translatePluralization(e,n);if(null==i)return u.getFallbackTranslation(e,o,a);r(i)}catch(t){r(u.handleError(t,e))}},o,a)},t.prototype.getFallbackTranslation=function(t,i,r){return console.log("Localized string with key="+t+" was not found in dictionary="+i+" with culture="+r),{name:t,value:"X{undefined}",resourceNotFound:!0}},t.prototype.handleError=function(t,i){return console.error(t.message),{name:i,value:"X{error}",resourceNotFound:!0}},t.prototype.configureSiteUrl=function(t){this.mSiteUrl=t},t.prototype.getDictionary=function(t,i){return t=this.checkScope(t),i=this.checkCultureName(i),this.getLocalizationDictionary(t,i)},t.prototype.getDictionaryAsync=function(t,i,r){return i=this.checkScope(i),r=this.checkCultureName(r),this.getLocalizationDictionaryAsync(i,r,t)},t.prototype.getPluralizationDictionary=function(t,i){return t=this.checkScope(t),i=this.checkCultureName(i),this.getPluralizationLocalizationDictionary(t,i)},t.prototype.getPluralizationDictionaryAsync=function(t,i,r){return i=this.checkScope(i),r=this.checkCultureName(r),this.getPluralizationLocalizationDictionaryAsync(i,r,t)},t.prototype.checkCultureName=function(t){return t||this.checkAndGetCurrentCulture()},t.prototype.checkScope=function(t){return t||this.mGlobalScope},t.prototype.getLocalizationDictionary=function(t,i){var r=this.dictionaryKey(t,i),e=this.mDictionary[r];return void 0===e?(this.downloadDictionary(t,i),this.mDictionary[r]):e},t.prototype.getLocalizationDictionaryAsync=function(t,i,r){var e=this.dictionaryKey(t,i),n=this.mDictionary[e];void 0===n?this.downloadDictionaryAsync(t,i,r):r(n)},t.prototype.getPluralizationLocalizationDictionary=function(t,i){var r=this.dictionaryKey(t,i),e=this.mPluralizedDictionary[r];return void 0===e?(this.downloadPluralizedDictionary(t,i),this.mPluralizedDictionary[r]):e},t.prototype.getPluralizationLocalizationDictionaryAsync=function(t,i,r){var e=this.dictionaryKey(t,i),n=this.mPluralizedDictionary[e];void 0===n?this.downloadPluralizedDictionaryAsync(t,i,r):r(n)},t.prototype.dictionaryKey=function(t,i){return t.concat("|",i)},t.prototype.downloadDictionary=function(i,t){var r=this,e=this.dictionaryKey(i,t);void 0===this.mDictionaryQueue[i]&&(this.mDictionaryQueue[i]=[]);var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE&&200===n.status){var t=n.responseText;void 0===r.mDictionary[e]&&(r.mDictionary[e]=new LocalizationDictionary(t)),r.processDictionaryQueue(i,e)}},n.open("GET",this.getBaseUrl()+"/Localization/Dictionary?scope="+i,!1),n.send()},t.prototype.downloadDictionaryAsync=function(i,t,r){var e=this,n=this.dictionaryKey(i,t);if(void 0===this.mDictionaryQueue[i]){this.mDictionaryQueue[i]=[];var o=new XMLHttpRequest;o.onreadystatechange=function(){if(o.readyState===XMLHttpRequest.DONE&&200===o.status){var t=o.responseText;void 0===e.mDictionary[n]&&(e.mDictionary[n]=new LocalizationDictionary(t)),e.processDictionaryQueue(i,n)}},o.open("GET",this.getBaseUrl()+"/Localization/Dictionary?scope="+i,!0),o.send()}this.mDictionaryQueue[i].push(r),this.processDictionaryQueue(i,n)},t.prototype.processDictionaryQueue=function(t,i){if(void 0!==this.mDictionary[i])for(var r=this.mDictionaryQueue[t].shift();void 0!==r;)r(this.mDictionary[i]),r=this.mDictionaryQueue[t].shift()},t.prototype.downloadPluralizedDictionary=function(i,t){var r=this,e=this.dictionaryKey(i,t);void 0===this.mPluralizedDictionaryQueue[i]&&(this.mPluralizedDictionaryQueue[i]=[]);var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE&&200===n.status){var t=n.responseText;void 0===r.mPluralizedDictionary[e]&&(r.mPluralizedDictionary[e]=new LocalizationPluralizationDictionary(t)),r.processPluralizedDictionaryQueue(i,e)}},n.open("GET",this.getBaseUrl()+"/Localization/PluralizedDictionary?scope="+i,!1),n.send()},t.prototype.downloadPluralizedDictionaryAsync=function(i,t,r){var e=this,n=this.dictionaryKey(i,t);if(void 0===this.mPluralizedDictionaryQueue[i]){this.mPluralizedDictionaryQueue[i]=[];var o=new XMLHttpRequest;o.onreadystatechange=function(){if(o.readyState===XMLHttpRequest.DONE&&200===o.status){var t=o.responseText;void 0===e.mPluralizedDictionary[n]&&(e.mPluralizedDictionary[n]=new LocalizationPluralizationDictionary(t)),e.processPluralizedDictionaryQueue(i,n)}},o.open("GET",this.getBaseUrl()+"/Localization/PluralizedDictionary?scope="+i,!0),o.send()}this.mPluralizedDictionaryQueue[i].push(r),this.processPluralizedDictionaryQueue(i,n)},t.prototype.processPluralizedDictionaryQueue=function(t,i){if(void 0!==this.mPluralizedDictionary[i])for(var r=this.mPluralizedDictionaryQueue[t].shift();void 0!==r;)r(this.mPluralizedDictionary[i]),r=this.mPluralizedDictionaryQueue[t].shift()},t.prototype.getBaseUrl=function(){var t=this.mSiteUrl;return t&&"/"===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1)),t},t.prototype.checkAndGetCurrentCulture=function(){if(void 0===this.mCurrentCulture){var t=this.getParsedCultureCookie().currentCulture;this.setCurrentCulture(t)}return this.mCurrentCulture},t.prototype.getCurrentCulture=function(){if(void 0!==this.mCurrentCulture)return this.mCurrentCulture;var t=this.getParsedCultureCookie();return t.currentCulture?t.currentCulture:t.defaultCulture},t.prototype.setCurrentCulture=function(t){this.mCurrentCulture=t},t.prototype.getParsedCultureCookie=function(){var t=this.getCurrentCultureCookie();return JSON.parse(t)},t.prototype.getCurrentCultureCookie=function(){return LocalizationUtils.getCookie(this.mCultureCookieName)},t}(),LocalizationDictionary=function(){function t(t){this.mDictionary=JSON.parse(t)}return t.prototype.translate=function(t){var i=this.mDictionary[t];return void 0===i?null:i},t.prototype.translateFormat=function(t,i){var r=this.translate(t);return{name:t,value:i?this.formatString(r,i):r.value,resourceNotFound:r.resourceNotFound}},t.prototype.formatString=function(t,n){return t.value.replace(/\{\s*([^}\s]+)\s*\}/g,function(t,i,r,e){return n[i]})},t}(),LocalizationPluralizationDictionary=function(){function t(t){this.mDictionary=JSON.parse(t)}return t.prototype.translatePluralization=function(t,i){var r=this.mDictionary[t];if(null==r)return null;for(var e=0,n=r.intervals;e<n.length;e++){var o=n[e],a=o.interval;if(LocalizationUtils.isInInterval(i,a))return o.localizedString}return r.defaultLocalizedString},t}(),PluralizationInterval=function(t,i){if(i<t)throw new Error("The start value should be less or equal than end.");this.start=t,this.end=i},LocalizationUtils=function(){function t(){}return t.getCookie=function(i){return i+="=",document.cookie.split(";").map(function(t){return t.trim()}).filter(function(t){return 0===t.indexOf(i)}).map(function(t){return decodeURIComponent(t.substring(i.length))})[0]||null},t.isInInterval=function(t,i){return!!i&&(i.start<=t&&t<=i.end)},t}();